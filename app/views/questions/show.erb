<h2><%= @question.body %></h2>
<h5>asked by <%= @user_question.username%></h5>

<% if !session[:user_id].nil? %>
	<% if @question.user_id == current_user.id%>

		<form action="/questions/<%= @question.id %>/edit" method="GET">
			<input type="submit" value="Edit Question">
		</form>

		<form action="/questions/<%= @question.id %>" method="post">
			<input type="hidden" name="_method" value="delete">
			<input type="submit" value="Delete Question">
		</form>

	<% else %>
		<form action="/questions/<%= @question.id %>/answers/new" method="get">
			<input type="submit" value="Answer this question">
		</form>	
	<% end %> 
<% end %>

<h3>All Answers:</h3>

<% @answers.each_with_index do |a, index| %>

	<% if !session[:user_id].nil? %>

		<% if a.user_id == current_user.id %>
	    	<p><%= "#{index + 1})  #{a.body}" %></p>
			<form action="/answers/<%= a.id %>/edit" method="GET">
				<input type="submit" value="Edit your answer">
			</form>

			<form action="/answers/<%= a.id %>" method="post">
				<input type="hidden" name="_method" value="delete">
				<input type="submit" value="Delete your answer">
			</form>
		<% else %>
  			<% user = User.find_by(id: a.user_id) %>
			<p><%= "#{index + 1})  #{a.body} &nbsp (#{user.username})" %></p>

			<!-- buttons only appear if user has not voted -->
				<% session = [a.id, user.id] %>
				<% session_string = session.join(",").to_s %>

			<% if Answervote.find_by(answersession: session_string).nil? %>

				<div class="vote_buttons">
	
			<!-- upvote submit button -->
				<form action="/questions/<%= a.question_id %>" method="post">
					<input type="hidden" name=answervote[value] value=1>
					<input type="hidden" name=answervote[answer_id] value="<%= a.id %>">
					<input type="hidden" name=answervote[user_id] value="<%= a.user_id%>">

					<% answ_sess_arr = Array.new %>
					<% answ_sess_arr << a.id << a.user_id %>
					<% answ_sess = answ_sess_arr.join(",").to_s %>

					<input type="hidden" name=answervote[answersession] value="<%= answ_sess %>">
					<input type="submit" value="Upvote">
				</form>


			<!-- downvote submit button -->
				<form action="/questions/<%= a.question_id %>" method="post">
					<input type="hidden" name=answervote[value] value=-1>
					<input type="hidden" name=answervote[answer_id] value="<%= a.id %>">
					<% answ_sess_arr = Array.new %>
					<% answ_sess_arr << a.id << a.user_id %>
					<% answ_sess = answ_sess_arr.join(",").to_s %>

					<input type="hidden" name=answervote[answersession] value="<%= answ_sess %>">
					<input type="hidden" name=answervote[user_id] value="<%= a.user_id%>">
					<input type="submit" value="Downvote">
				</form>
			<% end %>
		<% end %>
			</div>
	<% else %>
		<% user = User.find_by(id: a.user_id) %>
		<p><%= "#{index + 1})  #{a.body} &nbsp (#{user.username})" %></p>
	<% end %>
<% end %>






